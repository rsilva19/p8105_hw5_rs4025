---
title: "Hw 5 p8105"
author: "Rebecca Silva"
date: "11/07/2019"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(viridis)
library(p8105.datasets)
library(kableExtra)

knitr::opts_chunk$set(
	echo = TRUE,
	warning = FALSE,
	message = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
theme_set(theme_minimal() + theme(legend.position = "bottom"))
```


** delete unused packages

## Problem 1 

```{r}
set.seed(10)

iris_with_missing = iris %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(Species = as.character(Species))

input = iris_with_missing$Sepal.Length

fill_missing = function(vec){
  if(is.numeric(vec)){
    ifelse(is.na(vec), mean(vec, na.rm = T), vec)
  }else{
    ifelse(is.na(vec), "virginica", vec)
  }
}


iris_filled = map(iris_with_missing, fill_missing)

```

For numeric variables, you should fill in missing values with the mean of non-missing values
For character variables, you should fill in missing values with "virginica"
Write a function that takes a vector as an argument; replaces missing values using the rules defined above; and returns the resulting vector. Apply this function to the columns of iris_with_missing using a map statement.

```{r, warning = F}
iris_with_missing %>% 
  mutate(Sepal.Length = replace(Sepal.Length, is.na(Sepal.Length), mean(Sepal.Length)))

fill_missing = function(x){
 if (is.numeric(x)){
   if( is.na(x)){
     
   }
    x = replace(x, is.na(x), mean(as.vector(x), na.rm = T))
  }else{
    col = replace(col, is.na(col), "virginica")
  }
}



output = vector("vector", length = 4)

for (i in 1:5) {
  print(iris)
  iris_with_missing[i] = fill_missing(iris_with_missing[i])
}



for (i in 1:2) {
  iris_with_missing[i] = fill_missing(iris_with_missing[i])
}

numeric %in% (as.vector(iris_with_missing[1]))



mean_replace = function(){
  if()
  col = replace(col, is.na(col), mean(col, na.rm = T))
}


iris_nest = 
  iris_with_missing %>% 
  nest(-Species) %>% 
  mutate(col = map(.x, mean)

iris_numeric = 
  iris_with_missing %>% 
  select_if(is.numeric)

map(iris_numeric, mean_replace) 

iris_with_missing %>% 
  select_if(is.numeric) %>% 
  mutate(names() = mean_replace(names()))


iris_with_missing %>% 
  select_if(is.numeric) %>%
  map(names(), mean_replace)


  map(mutate, col = replace(col, is.na(col), mean(col)))
```

